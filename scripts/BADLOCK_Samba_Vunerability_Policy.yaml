---
- MiqPolicy:
    name: b1331fe4-002f-11e6-b643-005056a99011
    description: BADLOCK Samba Vulnerability
    expression: !ruby/object:MiqExpression
      exp:
        INCLUDES:
          field: Vm-os_image_name
          value: linux
      context_type: 
    towhat: Vm
    guid: b1331fe4-002f-11e6-b643-005056a99011
    created_by: admin
    updated_by: admin
    notes: 'This policy validates VM compliance against samba, samba3x and samba4
      package versions affected by BADLOCK security flaw (CVE-2016-2118)

'
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEventDefinition:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 42b1bd96-317e-11e3-88e1-005056b80000
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: log
        description: Generate log message
        guid: e800c9aa-d60f-11e3-85b2-001a4ab4f909
        action_type: default
        options: {}
    - qualifier: success
      success_sequence: 2
      MiqEventDefinition:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 42b1bd96-317e-11e3-88e1-005056b80000
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: 339f0cc8-317e-11e3-88e1-005056b80000
        action_type: default
        options: {}
    Condition:
    - name: 49be178c-0030-11e6-b643-005056a99011
      description: Vulnerable BADLOCK samba packages (RHEL5/6/7)
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.6.23
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 9\.el6
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.0.23c
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 2\.el5\.2\.0\.2|2\.el5.2|2\b
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.0.25b
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 1\.el5_1\.4|1\.el5_1\.2|0\.el5\.4
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.0.28
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 1\.el5_2\.3|1\.el5_2\.1|0\.el5\.8
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.0.33
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 3\.40\.el5_10|3\.29\.el5_6\.5|3\.7\.el5_3\.5|3\.39\.el5_8|3\.29\.el5_6\.4|3\.7\.el5_3\.4|3\.38\.el5_8|3\.37\.el5|3\.29\.el5_7\.4|3\.29\.el5_6\.2|3\.15\.el5_4\.3|3\.7\.el5_3\.3|3\.29\.el5_5\.1|3\.29\.el5_5|3\.15\.el5_4\.2|3\.7\.el5_3\.2|3\.28\.el5|3\.15\.el5_4\.1|3\.15\.el5_4|3\.14\.el5|3\.7\.el5_3\.1|3\.7\.el5
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.5.4
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 68\.el6_0\.3|68\.el6_0\.2|68\.el6_0\.1|68\.el6
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.5.6
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 86\.el6_1\.5|86\.el6_1\.4|86\.el6
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.5.10
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 125\.el6|119\.el6_2|116\.el6_2|115\.el6_2|114\.el6
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.6.9
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 171\.el6_5|169\.1\.el6rhs|169\.el6_5|168\.el6_5|167\.10\.3\.el6rhs|167\.10\.1\.el6rhs|167\.10\.el6rhs|167\.5\.1\.el6rhs|167\.el6_5|164\.el6|160\.7\.el6rhs|160\.3\.el6rhs|151\.el6_4\.3|151\.el6_4\.1|151\.el6
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.6.23
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 25\.el6_7|24\.el6_7|21\.el6_7|20\.el6|14\.el6_6|12\.el6
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.6.509
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 169\.6\.el6rhs|169\.4\.el6rhs|169\.1\.el6rhs
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 4.1.12
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 21\.ael7b|23\.ael7b_1|24\.ael7b_1|24\.el7_1|23\.el7_1|21\.el7_1
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 4.1.17
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 16\.el6rhs|14\.el6rhs|13\.el6rhs|4\.el6rhs|14\.el7rhgs|13\.el7rhgs
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 4.1.1
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 38\.el7_0|37\.el7_0|35\.el7_0|33\.el7_0|31\.el7
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 4.2.3
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 12\.el7_2|11\.el7_2|10\.el7
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 4.2.4
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 15\.el6rhs|13\.el6rhs|15\.el7rhgs|13\.el7rhgs|9\.1\.el7rhgs|6\.el7rhgs
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba3x
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.3.5
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 0\.40\.el5
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba3x
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.3.8
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 0\.52\.el5_5\.2|0\.52\.el5_5|0\.51\.el5|0\.46\.el5
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba3x
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.5.4
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 0\.83\.el5_7\.2|0\.83\.el5|0\.70\.el5_6\.4|0\.70\.el5_6\.2|0\.70\.el5_6\.1|0\.70\.el5
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba3x
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.5.10
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 0\.110\.el5_8|0\.109\.el5_8|0\.108\.el5_8|0\.107\.el5
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba3x
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.6.6
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 0\.140\.el5_10|0\.139\.el5_10|0\.138\.el5_10|0\.136\.el5|0\.131\.el5_9|0\.129\.el5
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba3x
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 3.6.23
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 9\.el5_11|6\.el5|7\.el5
          - and:
            - CONTAINS:
                field: Vm.guest_applications-name
                value: samba4
            - FIND:
                search:
                  "=":
                    field: Vm.guest_applications-version
                    value: 4.0.0
                checkall:
                  REGULAR EXPRESSION MATCHES:
                    field: Vm.guest_applications-release
                    value: 68.el6_7.rc4|67.el6_7.rc4|66.el6_6.rc4|65.el6_5.rc4|64.el6.rc4|63.el6_5.rc4|63\.el6\.rc4|61.el6_5.rc4|60.el6_5.rc4|58.el6.rc4|57.el6_4.rc4|55.el6.rc4
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 49be178c-0030-11e6-b643-005056a99011
      filename: 
      applies_to_exp: 
      miq_policy_id: 
      notes: 
